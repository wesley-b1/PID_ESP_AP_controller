<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <title>Controle PID via WebSocket</title>
    <link rel="stylesheet" href="style.css">
    <script src="chart.js"></script>
</head>

<body>
    <h1>Controle PID - ESP32</h1>

    <div class="container">
        <div class="control-panel">
            <div>
                <label for="sp">Setpoint (SP):</label>
                <input type="number" id="sp" step="1" value="2.47">
            </div>
            <div>
                <label for="kp">Kp:</label>
                <input type="number" id="kp" step="0.01" value="2.0">
            </div>
            <div>
                <label for="ki">Ki:</label>
                <input type="number" id="ki" step="0.01" value="0.5">
            </div>
            <div>
                <label for="kd">Kd:</label>
                <input type="number" id="kd" step="0.01" value="0.0">
            </div>
            <div>
                <label for="planta">Planta (1–7):</label>
                <input type="number" id="planta" step="1" min="1" max="7" value="1" onchange="autoFillGains()">
            </div>
            <div>
                <label for="malha">Tipo de Malha:</label>
                <select id="malha">
                    <option value="aberta">Malha Aberta</option>
                    <option value="fechada">Malha Fechada</option>
                </select>
            </div>
            <div class="buttons">
                <button onclick="sendParams()">Enviar Parâmetros</button>
                <button onclick="sendStart()">Iniciar</button>
                <button onclick="sendStop()">Parar</button>
            </div>
            <p id="status">Conectando...</p>
        </div>

        <div class="gain-table">
            <h3>Ganhos Calculados Do PID Por Planta</h3>
            <table>
                <thead>
                    <tr>
                        <th>Planta</th>
                        <th>Kp</th>
                        <th>Ki</th>
                        <th>Kd</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1 de 1° ordem</td>
                        <td>0.2042</td>
                        <td>2.2691</td>
                        <td>0.000</td>
                    </tr>
                    <tr>
                        <td>2 de 1° ordem</td>
                        <td>0.6219</td>
                        <td>3.3958</td>
                        <td>0.000</td>
                    </tr>
                    <tr>
                        <td>3 de 1° ordem</td>
                        <td>6.2532</td>
                        <td>3.4886</td>
                        <td>0.000</td>
                    </tr>
                    <tr>
                        <td>4 de 1° ordem</td>
                        <td>5.6813</td>
                        <td>8.0834</td>
                        <td>0.000</td>
                    </tr>
                    <tr>
                        <td>5 de 2° ordem</td>
                        <td>0.1048</td>
                        <td>0.8811</td>
                        <td>0.0102</td>
                    </tr>
                    <tr>
                        <td>6 de 2° ordem</td>
                        <td>0.2195</td>
                        <td>0.2211</td>
                        <td>0.1105</td>
                    </tr>
                    <tr>
                        <td>7 de 2° ordem</td>
                        <td>0.7832</td>
                        <td>0.4114</td>
                        <td>0.0905</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="chart-grid">
        <div class="chart-box">
            <h3>MV - Tensão Aplicada</h3>
            <canvas id="mvChart"></canvas>
        </div>
        <div class="chart-box">
            <h3>PV e SP - Tensão Medida</h3>
            <canvas id="pvChart"></canvas>
        </div>
    </div>

    <script src="/script.js"></script>
</body>

</html>